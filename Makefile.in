LD            = $(CXX)
CFLAGS        = -Wall -I/usr/include/libjson -I/usr/include/mongo-client -I/usr/include/glib-2.0 \
			-DNDEBUG
CXXFLAGS      = $(CFLAGS)
LIBS          = -lircclient -ljson -lmongo-client
OBJECTS_DIR   = build

SOURCES       = src/main.cpp \
		src/dazeus.cpp \
		src/network.cpp \
		src/config.cpp \
		src/user.cpp \
		src/server.cpp \
		src/database.cpp \
		src/plugincomm.cpp \
		src/utils.cpp
OBJECTS       = $(OBJECTS_DIR)/main.o \
		$(OBJECTS_DIR)/dazeus.o \
		$(OBJECTS_DIR)/network.o \
		$(OBJECTS_DIR)/config.o \
		$(OBJECTS_DIR)/user.o \
		$(OBJECTS_DIR)/server.o \
		$(OBJECTS_DIR)/database.o \
		$(OBJECTS_DIR)/plugincomm.o \
		$(OBJECTS_DIR)/utils.o
DESTDIR       = bin/
TARGET        = bin/dazeus

all: $(TARGET)

$(TARGET): $(OBJECTS)
	@mkdir -p bin
	$(LD) $(LFLAGS) -o $(TARGET) $(OBJECTS) $(OBJCOMP) $(LIBS)

distclean: clean
	-$(DEL_FILE) $(TARGET)
	-$(DEL_FILE) Makefile

clean:
	rm -f $(OBJECTS)
	rmdir $(OBJECTS_DIR)

$(OBJECTS_DIR)/main.o: src/main.cpp src/dazeus.h \
		src/network.h \
		src/user.h \
		src/dazeusglobal.h
	@mkdir -p $(OBJECTS_DIR)
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $(OBJECTS_DIR)/main.o src/main.cpp

$(OBJECTS_DIR)/dazeus.o: src/dazeus.cpp src/dazeus.h \
		src/network.h \
		src/user.h \
		src/database.h \
		src/config.h \
		src/plugincomm.h
	@mkdir -p $(OBJECTS_DIR)
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $(OBJECTS_DIR)/dazeus.o src/dazeus.cpp

$(OBJECTS_DIR)/network.o: src/network.cpp src/network.h \
		src/user.h \
		src/server.h \
		src/config.h \
		src/plugincomm.h
	@mkdir -p $(OBJECTS_DIR)
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $(OBJECTS_DIR)/network.o src/network.cpp

$(OBJECTS_DIR)/config.o: src/config.cpp src/config.h \
		src/database.h
	@mkdir -p $(OBJECTS_DIR)
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $(OBJECTS_DIR)/config.o src/config.cpp

$(OBJECTS_DIR)/user.o: src/user.cpp src/user.h \
		src/network.h
	@mkdir -p $(OBJECTS_DIR)
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $(OBJECTS_DIR)/user.o src/user.cpp

$(OBJECTS_DIR)/server.o: src/server.cpp src/server.h \
		src/user.h \
		src/network.h \
		src/config.h
	@mkdir -p $(OBJECTS_DIR)
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $(OBJECTS_DIR)/server.o src/server.cpp

$(OBJECTS_DIR)/database.o: src/database.cpp src/database.h \
		src/config.h
	@mkdir -p $(OBJECTS_DIR)
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $(OBJECTS_DIR)/database.o src/database.cpp

$(OBJECTS_DIR)/plugincomm.o: src/plugincomm.cpp src/plugincomm.h \
		src/network.h \
		src/user.h \
		src/config.h \
		src/server.h \
		src/dazeus.h \
		src/database.h
	@mkdir -p $(OBJECTS_DIR)
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $(OBJECTS_DIR)/plugincomm.o src/plugincomm.cpp

$(OBJECTS_DIR)/utils.o: src/utils.cpp
	@mkdir -p $(OBJECTS_DIR)
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $(OBJECTS_DIR)/utils.o src/utils.cpp
